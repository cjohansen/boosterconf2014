# Picture! Puzzle! Pizuzzle!

Welcome to the picture slider puzzle. This repo will guide you through building
your first Node.JS/React app. You may not always have wanted a multi-player
picture slider, but that's what you'll get when you're done.

## Your next assignment

Our server is more or less functional at this point. We also have the basics of
the UI; enough to leverage our domain model to play the game in boring old
single-player mode.

Your next task is to complete the UI so it can render an exciting multi-player
game. Think of the possibilities: strangers on the internet, gathering to engage
with your brand in a fierce death-match of Pizuzzle!

## Finding your way around

The app structure is the same as in the previous round, with some files added to
the `public/scripts` directory.

* **Readme.md** - it's this file!
* **buster.js** - the test runner configuration
* **index.js** - the main entrance point to the app. `node index.js` will start
  the web server.
* **package.json** - this your pom.xml/Gemfile/project.clj or whatever. It
  describes your project, and, importantly, its dependencies and development
  dependencies.
* **public** - any file in this directory will be served as-is over the web server
* **src** - this is where you'll do your work
* **test** - these are your goals. Making these pass will help you progress
  through the exercises.

## Getting up to speed

If you didn't have time to finish the first exercise, you can find solutions
ready for copy-paste here:

* [puzzle.js](https://gist.github.com/cjohansen/f5d0908eb4c92f00d877)
* [server.js](https://gist.github.com/cjohansen/5d487c4f701d53a0989e)

## Exercise #2: Multiplayer UI

Open `public/scripts/multiplayer-ui.js`. You will now add another component or
two "on top" of the existing ones (which are in `public/scripts/pizuzzle-ui.js`,
do not edit this file). Your goal is to have both player's games rendered on
screen.

To get started, create `multiplayer-ui.js` with this content:

```js
var target = document.getElementById("puzzle-container");
var picture = target.getElementsByTagName("img")[0].src;

function render(game, player) {
    var puzzleUI = Pizuzzle({
        layout: player.layout,
        picture: player.picture,
        move: function (slot) {
            puzzle.move(game, player, slot.id);
            render(game, player);
        }
    });

    React.renderComponent(puzzleUI, target);
}

var game = puzzle.createGame(3);
var player = puzzle.addPlayer(game, "Christian", picture);

render(game, player);
```

This should allow you to start the server, upload a picture, and Pizuzzle it.

### Add the multiplayer component

You will now design a `MultiplayerPuzzle` component that receives the whole game
as its input. It should generate markup roughly like this:

```html
<div id="puzzle-container" data-game-id="0" data-player-id="0">
  <div class="jumbotron">
    <h1>[MESSAGE PLACEHOLDER]</h1>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2>[PLAYER 1 NAME]</h2>
      [PLAYER 1 LAYOUT]
    </div>
    <div class="col-md-6">
      <h2>[PLAYER 2 NAME]</h2>
      [PLAYER 2 LAYOUT]
    </div>
  </div>
</div>
```

If it makes sense to you to design this as two or more components, please do.
One suggestion is to work with a component tree like this:

```text
MultiplayerPuzzle
  - Player
    - Pizuzzle
      - Slot
      - Slot
      ...
  - Player
    - Pizuzzle
      - Slot
      - Slot
      ...
```

You need to take a few cases into consideration:

1. When rendering a game with no players, the h1 message should be something
   like "Waiting for players"

2. When rendering a game with only one player, the h1 message should be
   something like "Waiting for the next player". Also, the first player should
   be rendered, but the game should not be randomized. One way to achieve this
   is to take the player's layout and sort it:

        arr.sort(function (a, b) {
           // a should be before b if someFunction returns true,
           // otherwise, after
           return someFunction(a, b) ? -1 : 1;
        });

3. When rendering a game with two players, render both games like normal, but
   only the game on the left should be playable. We will assume that another
   player is controlling the right one.

To simulate these cases, try this:

```js
function render(game) {
    React.renderComponent(MultiplayerPuzzle(game), target);
}

// No players
var game = puzzle.createGame(3);
render(game);

setTimeout(function () {
    var player = puzzle.addPlayer(game, "John", picture);
    // One player
    render(game);
}, 5000);

setTimeout(function () {
    var player = puzzle.addPlayer(game, "Jane", "http://upload.wikimedia.org/wikipedia/commons/4/4c/Lolcat.jpg");
    // Two players
    render(game);
}, 10000);
```

This will take your game through all three phases, 5 seconds apart.

NB! This example is simplified, and does not handle clicking to move slots.
That's your job.

To actually run your app, you need to run the server and upload a picture:

```sh
node index.js
```

[App is here](http://localhost:3000/).
